# clear all
rm(list = ls())

library(stringr)
library(dplyr)
library(tidyr)

# import data
new_data_children <- read.table('./data/children_new_R.dat', sep=' ')

# assign appropriate variable names
names(new_data_children) <- c('C0000100',
                              'C0000200',
                              'C0005300',
                              'C0005400',
                              'C0005700',
                              'C0008100',
                              'C0008600',
                              'C0009100',
                              'C0009600',
                              'C0009700',
                              'C0010110',
                              'C0010200',
                              'C0010700',
                              'C0011110',
                              'C0011112',
                              'C0011117',
                              'C0011122',
                              'C0011127',
                              'C0011132',
                              'C0011137',
                              'C0011142',
                              'C0053502',
                              'C0054101',
                              'C0055101',
                              'C0057501',
                              'C0058101',
                              'C0058701',
                              'C0059301',
                              'C0059901',
                              'C0061133',
                              'C0061134',
                              'C0061135',
                              'C0061136',
                              'C0061137',
                              'C0061138',
                              'C0061139',
                              'C0061140',
                              'C0061141',
                              'C0061142',
                              'C0061143',
                              'C0061144',
                              'C0061145',
                              'C0061146',
                              'C0730000',
                              'C0941300',
                              'C1134800',
                              'C1363300',
                              'C1585400',
                              'C1923700',
                              'C2461900',
                              'C2763200',
                              'C3042100',
                              'C3364600',
                              'C3601700',
                              'C3602401',
                              'C3868300',
                              'C3981700',
                              'C3982401',
                              'C5116500',
                              'C5525500',
                              'C5526300',
                              'C5693800',
                              'C5801800',
                              'C5802600',
                              'C5965700',
                              'C6051100',
                              'C6051504',
                              'Y0009800',
                              'Y0396800',
                              'Y0686600',
                              'Y0992300',
                              'Y0992301',
                              'Y0992302',
                              'Y0992303',
                              'Y0992304',
                              'Y0992305',
                              'Y1232900',
                              'Y1232901',
                              'Y1232902',
                              'Y1232903',
                              'Y1232904',
                              'Y1232905',
                              'Y1462700',
                              'Y1462701',
                              'Y1462702',
                              'Y1462703',
                              'Y1462704',
                              'Y1462705',
                              'Y1709900',
                              'Y1709901',
                              'Y1709902',
                              'Y1709903',
                              'Y1709904',
                              'Y1709905',
                              'Y1995500',
                              'Y1995501',
                              'Y1995502',
                              'Y1995503',
                              'Y1995504',
                              'Y1995505',
                              'Y1995506',
                              'Y2267000',
                              'Y2314300',
                              'Y2314301',
                              'Y2314302',
                              'Y2314303',
                              'Y2314304',
                              'Y2314305',
                              'Y2314306',
                              'Y2647000',
                              'Y2647001',
                              'Y2647002',
                              'Y2647003',
                              'Y2647004',
                              'Y2647005',
                              'Y2647006',
                              'Y3004200',
                              'Y3004201',
                              'Y3004202',
                              'Y3004203',
                              'Y3004204',
                              'Y3004205',
                              'Y3004206',
                              'Y3373000',
                              'Y3373001',
                              'Y3373002',
                              'Y3373003',
                              'Y3373004',
                              'Y3373005',
                              'Y3373006',
                              'Y4014100',
                              'Y4014101',
                              'Y4014102',
                              'Y4014103',
                              'Y4014104',
                              'Y4014105',
                              'Y4014106')


# Handle missing values

new_data_children[new_data_children == -1] = NA  # Refused
new_data_children[new_data_children == -2] = NA  # Dont know
new_data_children[new_data_children == -3] = NA  # Invalid missing
new_data_children[new_data_children == -7] = NA  # Missing


# If there are values not categorized they will be represented as NA

vallabels_children = function(data) {
  data$C0005300 <- factor(data$C0005300,
levels=c(1.0,2.0,3.0),
labels=c("HISPANIC",
"BLACK",
"NON-BLACK, NON-HISPANIC"))
  data$C0005400 <- factor(data$C0005400,
levels=c(1.0,2.0),
labels=c("MALE",
"FEMALE"))
  data$C0008100 <- factor(data$C0008100,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0008600 <- factor(data$C0008600,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0009100 <- factor(data$C0009100,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0009600 <- factor(data$C0009600,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0009700 <- factor(data$C0009700,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0010110 <- factor(data$C0010110,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0010200 <- factor(data$C0010200,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0010700 <- factor(data$C0010700,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0011110 <- factor(data$C0011110,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0011112 <- factor(data$C0011112,
levels=c(0.0,1.0),
labels=c("NO",
"YES"))
  data$C0011117 <- factor(data$C0011117,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C0011122 <- factor(data$C0011122,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C0011127 <- factor(data$C0011127,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C0011132 <- factor(data$C0011132,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C0011137 <- factor(data$C0011137,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C0011142 <- factor(data$C0011142,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C0053502 <- factor(data$C0053502,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0054101 <- factor(data$C0054101,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0055101 <- factor(data$C0055101,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0057501 <- factor(data$C0057501,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0058101 <- factor(data$C0058101,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0058701 <- factor(data$C0058701,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0059301 <- factor(data$C0059301,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0059901 <- factor(data$C0059901,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061133 <- factor(data$C0061133,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061134 <- factor(data$C0061134,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061135 <- factor(data$C0061135,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061136 <- factor(data$C0061136,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061137 <- factor(data$C0061137,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061138 <- factor(data$C0061138,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061139 <- factor(data$C0061139,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061140 <- factor(data$C0061140,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061141 <- factor(data$C0061141,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061142 <- factor(data$C0061142,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061143 <- factor(data$C0061143,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061144 <- factor(data$C0061144,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061145 <- factor(data$C0061145,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0061146 <- factor(data$C0061146,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C0730000 <- factor(data$C0730000,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0),
labels=c("LEAVE HIGH SCHOOL BEFORE GRAUDATION",
"GRADUATE FROM HIGH SCHOOL",
"GET SOME COLLEGE OR OTHER TRAINING",
"GRADUATE FROM COLLEGE",
"GET MORE THAN 4 YEARS OF COLLEGE",
"SOMETHING ELSE?",
"ALREADY LEFT SCHOOL"))
  data$C0941300 <- factor(data$C0941300,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0,7.0),
labels=c("LEAVE HIGH SCHOOL BEFORE GRAUDATION",
"GRADUATE FROM HIGH SCHOOL",
"GET SOME COLLEGE OR OTHER TRAINING",
"GRADUATE FROM COLLEGE",
"GET MORE THAN 4 YEARS OF COLLEGE",
"SOMETHING ELSE?",
"ALREADY LEFT SCHOOL"))
  data$C1134800 <- factor(data$C1134800,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("LEAVE HIGH SCHOOL BEFORE GRADUATION",
"GRADUATE FROM HIGH SCHOOL",
"GET SOME COLLEGE OR OTHER TRAINING",
"GRADUATE FROM COLLEGE",
"GET MORE THAN 4 YEARS OF COLLEGE",
"SOMETHING ELSE"))
  data$C1363300 <- factor(data$C1363300,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("LEAVE HIGH SCHOOL BEFORE GRADUATION",
"GRADUATE FROM HIGH SCHOOL",
"GET SOME COLLEGE OR OTHER TRAINING",
"GRADUATE FROM COLLEGE",
"GET MORE THAN 4 YEARS OF COLLEGE",
"SOMETHING ELSE"))
  data$C1585400 <- factor(data$C1585400,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("LEAVE HIGH SCHOOL BEFORE GRADUATION",
"GRADUATE FROM HIGH SCHOOL",
"GET SOME COLLEGE OR OTHER TRAINING",
"GRADUATE FROM COLLEGE",
"GET MORE THAN 4 YEARS OF COLLEGE",
"SOMETHING ELSE"))
  data$C1923700 <- factor(data$C1923700,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("LEAVE HIGH SCHOOL BEFORE GRADUATION",
"GRADUATE FROM HIGH SCHOOL",
"GET SOME COLLEGE OR OTHER TRAINING",
"GRADUATE FROM COLLEGE",
"GET MORE THAN 4 YEARS OF COLLEGE",
"SOMETHING ELSE"))
  data$C2461900 <- factor(data$C2461900,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("LEAVE HIGH SCHOOL BEFORE GRADUATION",
"GRADUATE FROM HIGH SCHOOL",
"GET SOME COLLEGE OR OTHER TRAINING",
"GRADUATE FROM COLLEGE",
"GET MORE THAN 4 YEARS OF COLLEGE",
"SOMETHING ELSE"))
  data$C2763200 <- factor(data$C2763200,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Leave high school before graduation",
"Graduate from high school",
"Get some college or other training",
"Graduate from college",
"Get more than 4 years of college",
"Something else"))
  data$C3042100 <- factor(data$C3042100,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Leave high school before graduation",
"Graduate from high school",
"Get some college or other training",
"Graduate from college",
"Get more than 4 years of college",
"Something else"))
  data$C3364600 <- factor(data$C3364600,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Leave high school before graduation",
"Graduate from high school",
"Get some college or other training",
"Graduate from college",
"Get more than 4 years of college",
"Something else"))
  data$C3601700 <- factor(data$C3601700,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C3602401 <- factor(data$C3602401,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C3868300 <- factor(data$C3868300,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Leave high school before graduation",
"Graduate from high school",
"Get some college or other training",
"Graduate from college",
"Get more than 4 years of college",
"Something else"))
  data$C3981700 <- factor(data$C3981700,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C3982401 <- factor(data$C3982401,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C5116500 <- factor(data$C5116500,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Leave high school before graduation",
"Graduate from high school",
"Get some college or other training",
"Graduate from college",
"Get more than 4 years of college",
"Something else"))
  data$C5525500 <- factor(data$C5525500,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C5526300 <- factor(data$C5526300,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C5693800 <- factor(data$C5693800,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Leave high school before graduation",
"Graduate from high school",
"Get some college or other training",
"Graduate from college",
"Get more than 4 years of college",
"Something else"))
  data$C5801800 <- factor(data$C5801800,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C5802600 <- factor(data$C5802600,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$C5965700 <- factor(data$C5965700,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Leave high school before graduation",
"Graduate from high school",
"Get some college or other training",
"Graduate from college",
"Get more than 4 years of college",
"Something else"))
  data$C6051100 <- factor(data$C6051100,
levels=c(0.0,1.0),
labels=c("No",
"Yes"))
  data$C6051504 <- factor(data$C6051504,
levels=c(0.0,1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0,9.0,10.0,11.0,12.0,13.0,14.0,15.0,16.0,17.0,18.0,19.0,20.0,95.0),
labels=c("NONE",
"1ST GRADE",
"2ND GRADE",
"3RD GRADE",
"4TH GRADE",
"5TH GRADE",
"6TH GRADE",
"7TH GRADE",
"8TH GRADE",
"9TH GRADE",
"10TH GRADE",
"11TH GRADE",
"12TH GRADE",
"1ST YR COL",
"2ND YR COL",
"3RD YR COL",
"4TH YR COL",
"5TH YR COL",
"6TH YR COL",
"7TH YR COL",
"8TH YR COL OR MORE",
"UNGRADED"))
  data$Y0009800 <- factor(data$Y0009800,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Black",
"White (non-Hispanic)",
"Hispanic",
"American Indian",
"Asian or Pacific Islander",
"Other (SPECIFY)"))
  data$Y0396800 <- factor(data$Y0396800,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("Black",
"White (non-Hispanic)",
"Hispanic",
"American Indian",
"Asian or Pacific Islander",
"Other (SPECIFY)"))
  data$Y0686600 <- factor(data$Y0686600,
levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
labels=c("White",
"Black or African American",
"American Indian or Alaska Native",
"Asian",
"Native Hawaiian or Other Pacific Islander",
"Other (SPECIFY)"))
  data$Y0992300 <- factor(data$Y0992300,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y1232900 <- factor(data$Y1232900,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y1462700 <- factor(data$Y1462700,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y1709900 <- factor(data$Y1709900,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y1995500 <- factor(data$Y1995500,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y2267000 <- factor(data$Y2267000,
levels=c(506.0),
labels=c("506"))
  data$Y2314300 <- factor(data$Y2314300,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y2647000 <- factor(data$Y2647000,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y3004200 <- factor(data$Y3004200,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y3373000 <- factor(data$Y3373000,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
  data$Y4014100 <- factor(data$Y4014100,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"White"))
return(data)
}


# If there are values not categorized they will be represented as NA

vallabels_continuous_children = function(data) {
data$C0000100[1.0 <= data$C0000100 & data$C0000100 <= 9999999.0] <- 1.0
data$C0000100 <- factor(data$C0000100,
levels=c(1.0),
labels=c("1 TO 9999999: See Min & Max values below for range as of this release"))
data$C0000200[1.0 <= data$C0000200 & data$C0000200 <= 12686.0] <- 1.0
data$C0000200 <- factor(data$C0000200,
levels=c(1.0),
labels=c("1 TO 12686: NLSY79 Public ID"))
data$C0005700[1970.0 <= data$C0005700 & data$C0005700 <= 1978.0] <- 1970.0
data$C0005700 <- factor(data$C0005700,
levels=c(1970.0,1979.0,1980.0,1981.0,1982.0,1983.0,1984.0,1985.0,1986.0,1987.0,1988.0,1989.0,1990.0,1991.0,1992.0,1993.0,1994.0,1995.0,1996.0,1997.0,1998.0,1999.0,2000.0,2001.0,2002.0,2003.0,2004.0,2005.0,2006.0,2007.0,2008.0,2009.0,2010.0,2011.0,2012.0,2013.0,2014.0,2015.0,2016.0,2017.0,2018.0,2019.0),
labels=c("1970 TO 1978: < before 1979",
"1979",
"1980",
"1981",
"1982",
"1983",
"1984",
"1985",
"1986",
"1987",
"1988",
"1989",
"1990",
"1991",
"1992",
"1993",
"1994",
"1995",
"1996",
"1997",
"1998",
"1999",
"2000",
"2001",
"2002",
"2003",
"2004",
"2005",
"2006",
"2007",
"2008",
"2009",
"2010",
"2011",
"2012",
"2013",
"2014",
"2015",
"2016",
"2017",
"2018",
"2019"))
data$Y0992301[1.0 <= data$Y0992301 & data$Y0992301 <= 2.0] <- 1.0
data$Y0992301 <- factor(data$Y0992301,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y0992302[1.0 <= data$Y0992302 & data$Y0992302 <= 3.0] <- 1.0
data$Y0992302 <- factor(data$Y0992302,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y0992303[1.0 <= data$Y0992303 & data$Y0992303 <= 4.0] <- 1.0
data$Y0992303 <- factor(data$Y0992303,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y0992304[1.0 <= data$Y0992304 & data$Y0992304 <= 5.0] <- 1.0
data$Y0992304 <- factor(data$Y0992304,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or Other Pacific Islander"))
data$Y0992305[1.0 <= data$Y0992305 & data$Y0992305 <= 6.0] <- 1.0
data$Y0992305 <- factor(data$Y0992305,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Other (SPECIFY)"))
data$Y1232901[1.0 <= data$Y1232901 & data$Y1232901 <= 2.0] <- 1.0
data$Y1232901 <- factor(data$Y1232901,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y1232902[1.0 <= data$Y1232902 & data$Y1232902 <= 3.0] <- 1.0
data$Y1232902 <- factor(data$Y1232902,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y1232903[1.0 <= data$Y1232903 & data$Y1232903 <= 4.0] <- 1.0
data$Y1232903 <- factor(data$Y1232903,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y1232904[1.0 <= data$Y1232904 & data$Y1232904 <= 5.0] <- 1.0
data$Y1232904 <- factor(data$Y1232904,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or Other Pacific Islander"))
data$Y1232905[1.0 <= data$Y1232905 & data$Y1232905 <= 6.0] <- 1.0
data$Y1232905 <- factor(data$Y1232905,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Other (SPECIFY)"))
data$Y1462701[1.0 <= data$Y1462701 & data$Y1462701 <= 2.0] <- 1.0
data$Y1462701 <- factor(data$Y1462701,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y1462702[1.0 <= data$Y1462702 & data$Y1462702 <= 3.0] <- 1.0
data$Y1462702 <- factor(data$Y1462702,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y1462703[1.0 <= data$Y1462703 & data$Y1462703 <= 4.0] <- 1.0
data$Y1462703 <- factor(data$Y1462703,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y1462704[1.0 <= data$Y1462704 & data$Y1462704 <= 5.0] <- 1.0
data$Y1462704 <- factor(data$Y1462704,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or Other Pacific Islander"))
data$Y1462705[1.0 <= data$Y1462705 & data$Y1462705 <= 6.0] <- 1.0
data$Y1462705 <- factor(data$Y1462705,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Other (SPECIFY)"))
data$Y1709901[1.0 <= data$Y1709901 & data$Y1709901 <= 2.0] <- 1.0
data$Y1709901 <- factor(data$Y1709901,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y1709902[1.0 <= data$Y1709902 & data$Y1709902 <= 3.0] <- 1.0
data$Y1709902 <- factor(data$Y1709902,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y1709903[1.0 <= data$Y1709903 & data$Y1709903 <= 4.0] <- 1.0
data$Y1709903 <- factor(data$Y1709903,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y1709904[1.0 <= data$Y1709904 & data$Y1709904 <= 5.0] <- 1.0
data$Y1709904 <- factor(data$Y1709904,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or Other Pacific Islander"))
data$Y1709905[1.0 <= data$Y1709905 & data$Y1709905 <= 6.0] <- 1.0
data$Y1709905 <- factor(data$Y1709905,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Other (SPECIFY)"))
data$Y1995501[1.0 <= data$Y1995501 & data$Y1995501 <= 2.0] <- 1.0
data$Y1995501 <- factor(data$Y1995501,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y1995502[1.0 <= data$Y1995502 & data$Y1995502 <= 4.0] <- 1.0
data$Y1995502 <- factor(data$Y1995502,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y1995503[1.0 <= data$Y1995503 & data$Y1995503 <= 5.0] <- 1.0
data$Y1995503 <- factor(data$Y1995503,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or other Pacific Islander"))
data$Y1995504[1.0 <= data$Y1995504 & data$Y1995504 <= 3.0] <- 1.0
data$Y1995504 <- factor(data$Y1995504,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y1995505[1.0 <= data$Y1995505 & data$Y1995505 <= 6.0] <- 1.0
data$Y1995505 <- factor(data$Y1995505,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Some other race (SPECIFY)"))
data$Y1995506[1.0 <= data$Y1995506 & data$Y1995506 <= 7.0] <- 1.0
data$Y1995506 <- factor(data$Y1995506,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Respondent refuses to classify own race except as Hispanic/Latino"))
data$Y2314301[1.0 <= data$Y2314301 & data$Y2314301 <= 2.0] <- 1.0
data$Y2314301 <- factor(data$Y2314301,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y2314302[1.0 <= data$Y2314302 & data$Y2314302 <= 3.0] <- 1.0
data$Y2314302 <- factor(data$Y2314302,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y2314303[1.0 <= data$Y2314303 & data$Y2314303 <= 4.0] <- 1.0
data$Y2314303 <- factor(data$Y2314303,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or other Pacific Islander"))
data$Y2314304[1.0 <= data$Y2314304 & data$Y2314304 <= 5.0] <- 1.0
data$Y2314304 <- factor(data$Y2314304,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y2314305[1.0 <= data$Y2314305 & data$Y2314305 <= 6.0] <- 1.0
data$Y2314305 <- factor(data$Y2314305,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) SOME OTHER RACE (SPECIFY)"))
data$Y2314306[1.0 <= data$Y2314306 & data$Y2314306 <= 7.0] <- 1.0
data$Y2314306 <- factor(data$Y2314306,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) RESPONDENT REFUSES TO CLASSIFY OWN RACE EXCEPT AS HISPANIC/LATINO"))
data$Y2647001[1.0 <= data$Y2647001 & data$Y2647001 <= 2.0] <- 1.0
data$Y2647001 <- factor(data$Y2647001,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y2647002[1.0 <= data$Y2647002 & data$Y2647002 <= 3.0] <- 1.0
data$Y2647002 <- factor(data$Y2647002,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y2647003[1.0 <= data$Y2647003 & data$Y2647003 <= 4.0] <- 1.0
data$Y2647003 <- factor(data$Y2647003,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or other Pacific Islander"))
data$Y2647004[1.0 <= data$Y2647004 & data$Y2647004 <= 5.0] <- 1.0
data$Y2647004 <- factor(data$Y2647004,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y2647005[1.0 <= data$Y2647005 & data$Y2647005 <= 6.0] <- 1.0
data$Y2647005 <- factor(data$Y2647005,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) SOME OTHER RACE (SPECIFY)"))
data$Y2647006[1.0 <= data$Y2647006 & data$Y2647006 <= 7.0] <- 1.0
data$Y2647006 <- factor(data$Y2647006,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) RESPONDENT REFUSES TO CLASSIFY OWN RACE EXCEPT AS HISPANIC/LATINO"))
data$Y3004201[1.0 <= data$Y3004201 & data$Y3004201 <= 2.0] <- 1.0
data$Y3004201 <- factor(data$Y3004201,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y3004202[1.0 <= data$Y3004202 & data$Y3004202 <= 3.0] <- 1.0
data$Y3004202 <- factor(data$Y3004202,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y3004203[1.0 <= data$Y3004203 & data$Y3004203 <= 4.0] <- 1.0
data$Y3004203 <- factor(data$Y3004203,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or other Pacific Islander"))
data$Y3004204[1.0 <= data$Y3004204 & data$Y3004204 <= 5.0] <- 1.0
data$Y3004204 <- factor(data$Y3004204,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y3004205[1.0 <= data$Y3004205 & data$Y3004205 <= 6.0] <- 1.0
data$Y3004205 <- factor(data$Y3004205,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) SOME OTHER RACE (SPECIFY)"))
data$Y3004206[1.0 <= data$Y3004206 & data$Y3004206 <= 7.0] <- 1.0
data$Y3004206 <- factor(data$Y3004206,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) RESPONDENT REFUSES TO CLASSIFY OWN RACE EXCEPT AS HISPANIC/LATINO"))
data$Y3373001[1.0 <= data$Y3373001 & data$Y3373001 <= 2.0] <- 1.0
data$Y3373001 <- factor(data$Y3373001,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y3373002[1.0 <= data$Y3373002 & data$Y3373002 <= 3.0] <- 1.0
data$Y3373002 <- factor(data$Y3373002,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y3373003[1.0 <= data$Y3373003 & data$Y3373003 <= 4.0] <- 1.0
data$Y3373003 <- factor(data$Y3373003,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or other Pacific Islander"))
data$Y3373004[1.0 <= data$Y3373004 & data$Y3373004 <= 5.0] <- 1.0
data$Y3373004 <- factor(data$Y3373004,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y3373005[1.0 <= data$Y3373005 & data$Y3373005 <= 6.0] <- 1.0
data$Y3373005 <- factor(data$Y3373005,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) SOME OTHER RACE (SPECIFY)"))
data$Y3373006[1.0 <= data$Y3373006 & data$Y3373006 <= 7.0] <- 1.0
data$Y3373006 <- factor(data$Y3373006,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) RESPONDENT REFUSES TO CLASSIFY OWN RACE EXCEPT AS HISPANIC/LATINO"))
data$Y4014101[1.0 <= data$Y4014101 & data$Y4014101 <= 2.0] <- 1.0
data$Y4014101 <- factor(data$Y4014101,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Black or African American"))
data$Y4014102[1.0 <= data$Y4014102 & data$Y4014102 <= 3.0] <- 1.0
data$Y4014102 <- factor(data$Y4014102,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Asian"))
data$Y4014103[1.0 <= data$Y4014103 & data$Y4014103 <= 4.0] <- 1.0
data$Y4014103 <- factor(data$Y4014103,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"Native Hawaiian or other Pacific Islander"))
data$Y4014104[1.0 <= data$Y4014104 & data$Y4014104 <= 5.0] <- 1.0
data$Y4014104 <- factor(data$Y4014104,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"American Indian or Alaska Native"))
data$Y4014105[1.0 <= data$Y4014105 & data$Y4014105 <= 6.0] <- 1.0
data$Y4014105 <- factor(data$Y4014105,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) SOME OTHER RACE (SPECIFY)"))
data$Y4014106[1.0 <= data$Y4014106 & data$Y4014106 <= 7.0] <- 1.0
data$Y4014106 <- factor(data$Y4014106,
levels=c(0.0,1.0),
labels=c("NOT SELECTED",
"(DO NOT READ ALOUD:) RESPONDENT REFUSES TO CLASSIFY OWN RACE EXCEPT AS HISPANIC/LATINO"))
return(data)
}

varlabels_children <- c("CHILD_ID",
"MOTHER_ID",
"RACE OF CHILD (FROM MOTHERS SCREENER 1979)",
"SEX OF CHILD",
"DATE OF BIRTH OF CHILD - YEAR",
"FATHER LIVE IN HH OF MOTHER? 1984",
"FATHER LIVE IN HH OF MOTHER? 1985",
"FATHER LIVE IN HH OF MOTHER? 1986",
"FATHER LIVE IN HH OF MOTHER? 1987",
"FATHER LIVE IN HH OF MOTHER? 1988",
"FATHER LIVE IN HH OF MOTHER? 1989",
"FATHER LIVE IN HH OF MOTHER? 1990",
"FATHER LIVE IN HH OF MOTHER? 1992",
"FATHER LIVE IN HH OF MOTHER? 1993",
"FATHER LIVE IN HH OF MOTHER? 1994",
"FATHER LIVE IN HH OF MOTHER? 1996",
"FATHER LIVE IN HH OF MOTHER? 1998",
"FATHER LIVE IN HH OF MOTHER? 2000",
"FATHER LIVE IN HH OF MOTHER? 2002",
"FATHER LIVE IN HH OF MOTHER? 2004",
"FATHER LIVE IN HH OF MOTHER? 2006",
"HGC OF MOTHER AS OF MAY 1 (REV) 1979",
"HGC OF MOTHER AS OF MAY 1 (REV) 1980",
"HGC OF MOTHER AS OF MAY 1 (REV) 1981",
"HGC OF MOTHER AS OF MAY 1 (REV) 1982",
"HGC OF MOTHER AS OF MAY 1 (REV) 1983",
"HGC OF MOTHER AS OF MAY 1 (REV) 1984",
"HGC OF MOTHER AS OF MAY 1 (REV) 1985",
"HGC OF MOTHER AS OF MAY 1 (REV) 1986",
"HGC OF MOTHER AS OF MAY 1 (REV) 1987",
"HGC OF MOTHER AS OF MAY 1 (REV) 1988",
"HGC OF MOTHER AS OF MAY 1 (REV) 1989",
"HGC OF MOTHER AS OF MAY 1 (REV) 1990",
"HGC OF MOTHER AS OF MAY 1 (REV) 1991",
"HGC OF MOTHER AS OF MAY 1 (REV) 1992",
"HGC OF MOTHER AS OF MAY 1 (REV) 1993",
"HGC OF MOTHER AS OF MAY 1 (REV) 1994",
"HGC OF MOTHER AS OF MAY 1 (REV) 1996",
"HGC OF MOTHER AS OF MAY 1 (REV) 1998",
"HGC OF MOTHER AS OF MAY 1 (REV) 2000",
"HGC OF MOTHER AS OF MAY 1 (REV) 2002",
"HGC OF MOTHER AS OF MAY 1 (REV) 2004",
"HGC OF MOTHER AS OF MAY 1 (REV) 2006",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 1988",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 1990",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 1992",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 1994",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 1996",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 1998",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 2000",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 2002",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 2004",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 2006",
"FATHER LIVE IN HH OF MOTHER? 2008",
"HGC OF MOTHER AS OF MAY 1 (REV) 2008",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 2008",
"FATHER LIVE IN HH OF MOTHER? 2010",
"HGC OF MOTHER AS OF MAY 1 (REV) 2010",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 2010",
"FATHER LIVE IN HH OF MOTHER? 2012",
"HGC OF MOTHER AS OF MAY 1 (REV) 2012",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 2012",
"FATHER LIVE IN HH OF MOTHER? 2014",
"HGC OF MOTHER AS OF MAY 1 (REV) 2014",
"HOW FAR CHILD EXPECTS TO GO IN SCHL 2014",
"FATHER LIVE IN HH OF MOTHER? 2016",
"HGC OF MOTHER AS OF MAY 1 (REV) 2016",
"RACE OF R 1994",
"RACE OF R 1996",
"RACE OF R 1998",
"RACE OF R - WHITE 2000",
"RACE OF R - BLACK OR AFRICAN AMER 2000",
"RACE OF R - AM INDIAN OR ALASKA NAT 2000",
"RACE OF R - ASIAN 2000",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2000",
"RACE OF R - OTHER RACE (SPECIFY) 2000",
"RACE OF R - WHITE 2002",
"RACE OF R - BLACK OR AFRICAN AMER 2002",
"RACE OF R - AM INDIAN OR ALASKA NAT 2002",
"RACE OF R - ASIAN 2002",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2002",
"RACE OF R - OTHER RACE (SPECIFY) 2002",
"RACE OF R - WHITE 2004",
"RACE OF R - BLACK OR AFRICAN AMER 2004",
"RACE OF R - AM INDIAN OR ALASKA NAT 2004",
"RACE OF R - ASIAN 2004",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2004",
"RACE OF R - OTHER RACE (SPECIFY) 2004",
"RACE OF R - WHITE 2006",
"RACE OF R - BLACK OR AFRICAN AMER 2006",
"RACE OF R - AM INDIAN OR ALASKA NAT 2006",
"RACE OF R - ASIAN 2006",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2006",
"RACE OF R - OTHER RACE (SPECIFY) 2006",
"RACE OF R - WHITE 2008",
"RACE OF R - BLACK OR AFRICAN AMER 2008",
"RACE OF R - ASIAN 2008",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2008",
"RACE OF R - AM INDIAN OR ALASKA NAT 2008",
"RACE OF R - OTHER RACE (SPECIFY) 2008",
"RACE OF R - HISPANIC/LATINO 2008",
"VERSION_R28 CHILD/YOUNG ADULT XRND",
"RACE OF R - WHITE 2010",
"RACE OF R - BLACK OR AFRICAN AMER 2010",
"RACE OF R - ASIAN 2010",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2010",
"RACE OF R - AM INDIAN OR ALASKA NAT 2010",
"RACE OF R - OTHER RACE (SPECIFY) 2010",
"RACE OF R - HISPANIC/LATINO 2010",
"RACE OF R - WHITE 2012",
"RACE OF R - BLACK OR AFRICAN AMER 2012",
"RACE OF R - ASIAN 2012",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2012",
"RACE OF R - AM INDIAN OR ALASKA NAT 2012",
"RACE OF R - OTHER RACE (SPECIFY) 2012",
"RACE OF R - HISPANIC/LATINO 2012",
"RACE OF R - WHITE 2014",
"RACE OF R - BLACK OR AFRICAN AMER 2014",
"RACE OF R - ASIAN 2014",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2014",
"RACE OF R - AM INDIAN OR ALASKA NAT 2014",
"RACE OF R - OTHER RACE (SPECIFY) 2014",
"RACE OF R - HISPANIC/LATINO 2014",
"RACE OF R - WHITE 2016",
"RACE OF R - BLACK OR AFRICAN AMER 2016",
"RACE OF R - ASIAN 2016",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2016",
"RACE OF R - AM INDIAN OR ALASKA NAT 2016",
"RACE OF R - OTHER RACE (SPECIFY) 2016",
"RACE OF R - HISPANIC/LATINO 2016",
"RACE OF R - WHITE 2018",
"RACE OF R - BLACK OR AFRICAN AMER 2018",
"RACE OF R - ASIAN 2018",
"RACE OF R - NAT HAWAIIAN, OTH PAC IS 2018",
"RACE OF R - AM INDIAN OR ALASKA NAT 2018",
"RACE OF R - OTHER RACE (SPECIFY) 2018",
"RACE OF R - HISPANIC/LATINO 2018"
)


# Use qnames rather than rnums

qnames_children = function(data) {
names(data) <- c("CPUBID_XRND",
"MPUBID_XRND",
"CRACE_XRND",
"CSEX_XRND",
"CYRB_XRND",
"DADHM1984_1984",
"DADHM1985_1985",
"DADHM1986_1986",
"DADHM1987_1987",
"DADHM1988_1988",
"DADHM1989_1989",
"DADHM1990_1990",
"DADHM1992_1992",
"DADHM1993_1993",
"DADHM1994_1994",
"DADHM1996_1996",
"DADHM1998_1998",
"DADHM2000_2000",
"DADHM2002_2002",
"DADHM2004_2004",
"DADHM2006_2006",
"HGCREV1979_1979",
"HGCREV1980_1980",
"HGCREV1981_1981",
"HGCREV1982_1982",
"HGCREV1983_1983",
"HGCREV1984_1984",
"HGCREV1985_1985",
"HGCREV1986_1986",
"HGCREV1987_1987",
"HGCREV1988_1988",
"HGCREV1989_1989",
"HGCREV1990_1990",
"HGCREV1991_1991",
"HGCREV1992_1992",
"HGCREV1993_1993",
"HGCREV1994_1994",
"HGCREV1996_1996",
"HGCREV1998_1998",
"HGCREV2000_2000",
"HGCREV2002_2002",
"HGCREV2004_2004",
"HGCREV2006_2006",
"CS884171_1988",
"CS906553_1990",
"CS926713_1992",
"CS942413_1994",
"CS960713_1996",
"CS98028_1998",
"CSAS028_2000",
"CSAS028_2002",
"CSAS028_2004",
"CSAS028_2006",
"DADHM2008_2008",
"HGCREV2008_2008",
"CSAS028_2008",
"DADHM2010_2010",
"HGCREV2010_2010",
"CSAS028_2010",
"DADHM2012_2012",
"HGCREV2012_2012",
"CSAS028_2012",
"DADHM2014_2014",
"HGCREV2014_2014",
"CSAS028_2014",
"DADHM2016_2016",
"HGCREV2016_2016",
"Q2-38A_1994",
"Q2-38A_1996",
"Q2-38A_1998",
"Q2-38A~000001_2000",
"Q2-38A~000002_2000",
"Q2-38A~000003_2000",
"Q2-38A~000004_2000",
"Q2-38A~000005_2000",
"Q2-38A~000006_2000",
"Q2-38A~000001_2002",
"Q2-38A~000002_2002",
"Q2-38A~000003_2002",
"Q2-38A~000004_2002",
"Q2-38A~000005_2002",
"Q2-38A~000006_2002",
"Q2-38A~000001_2004",
"Q2-38A~000002_2004",
"Q2-38A~000003_2004",
"Q2-38A~000004_2004",
"Q2-38A~000005_2004",
"Q2-38A~000006_2004",
"Q2-38A~000001_2006",
"Q2-38A~000002_2006",
"Q2-38A~000003_2006",
"Q2-38A~000004_2006",
"Q2-38A~000005_2006",
"Q2-38A~000006_2006",
"Q2-38A~000001_2008",
"Q2-38A~000002_2008",
"Q2-38A~000004_2008",
"Q2-38A~000005_2008",
"Q2-38A~000003_2008",
"Q2-38A~000006_2008",
"Q2-38A~000007_2008",
"VERSION_R28_XRND",
"Q2-38A~000001_2010",
"Q2-38A~000002_2010",
"Q2-38A~000003_2010",
"Q2-38A~000004_2010",
"Q2-38A~000005_2010",
"Q2-38A~000006_2010",
"Q2-38A~000007_2010",
"Q2-38A~000001_2012",
"Q2-38A~000002_2012",
"Q2-38A~000003_2012",
"Q2-38A~000004_2012",
"Q2-38A~000005_2012",
"Q2-38A~000006_2012",
"Q2-38A~000007_2012",
"Q2-38A~000001_2014",
"Q2-38A~000002_2014",
"Q2-38A~000003_2014",
"Q2-38A~000004_2014",
"Q2-38A~000005_2014",
"Q2-38A~000006_2014",
"Q2-38A~000007_2014",
"Q2-38A~000001_2016",
"Q2-38A~000002_2016",
"Q2-38A~000003_2016",
"Q2-38A~000004_2016",
"Q2-38A~000005_2016",
"Q2-38A~000006_2016",
"Q2-38A~000007_2016",
"Q2-38A~000001_2018",
"Q2-38A~000002_2018",
"Q2-38A~000003_2018",
"Q2-38A~000004_2018",
"Q2-38A~000005_2018",
"Q2-38A~000006_2018",
"Q2-38A~000007_2018")
return(data)
}


question_names_children <- c("CPUBID_XRND",
                                   "MPUBID_XRND",
                                   "CRACE_XRND",
                                   "CSEX_XRND",
                                   "CYRB_XRND",
                                   "DADHM1984_1984",
                                   "DADHM1985_1985",
                                   "DADHM1986_1986",
                                   "DADHM1987_1987",
                                   "DADHM1988_1988",
                                   "DADHM1989_1989",
                                   "DADHM1990_1990",
                                   "DADHM1992_1992",
                                   "DADHM1993_1993",
                                   "DADHM1994_1994",
                                   "DADHM1996_1996",
                                   "DADHM1998_1998",
                                   "DADHM2000_2000",
                                   "DADHM2002_2002",
                                   "DADHM2004_2004",
                                   "DADHM2006_2006",
                                   "HGCREV1979_1979",
                                   "HGCREV1980_1980",
                                   "HGCREV1981_1981",
                                   "HGCREV1982_1982",
                                   "HGCREV1983_1983",
                                   "HGCREV1984_1984",
                                   "HGCREV1985_1985",
                                   "HGCREV1986_1986",
                                   "HGCREV1987_1987",
                                   "HGCREV1988_1988",
                                   "HGCREV1989_1989",
                                   "HGCREV1990_1990",
                                   "HGCREV1991_1991",
                                   "HGCREV1992_1992",
                                   "HGCREV1993_1993",
                                   "HGCREV1994_1994",
                                   "HGCREV1996_1996",
                                   "HGCREV1998_1998",
                                   "HGCREV2000_2000",
                                   "HGCREV2002_2002",
                                   "HGCREV2004_2004",
                                   "HGCREV2006_2006",
                                   "CS884171_1988",
                                   "CS906553_1990",
                                   "CS926713_1992",
                                   "CS942413_1994",
                                   "CS960713_1996",
                                   "CS98028_1998",
                                   "CSAS028_2000",
                                   "CSAS028_2002",
                                   "CSAS028_2004",
                                   "CSAS028_2006",
                                   "DADHM2008_2008",
                                   "HGCREV2008_2008",
                                   "CSAS028_2008",
                                   "DADHM2010_2010",
                                   "HGCREV2010_2010",
                                   "CSAS028_2010",
                                   "DADHM2012_2012",
                                   "HGCREV2012_2012",
                                   "CSAS028_2012",
                                   "DADHM2014_2014",
                                   "HGCREV2014_2014",
                                   "CSAS028_2014",
                                   "DADHM2016_2016",
                                   "HGCREV2016_2016",
                                   "Q2-38A_1994",
                                   "Q2-38A_1996",
                                   "Q2-38A_1998",
                                   "Q2-38A~000001_2000",
                                   "Q2-38A~000002_2000",
                                   "Q2-38A~000003_2000",
                                   "Q2-38A~000004_2000",
                                   "Q2-38A~000005_2000",
                                   "Q2-38A~000006_2000",
                                   "Q2-38A~000001_2002",
                                   "Q2-38A~000002_2002",
                                   "Q2-38A~000003_2002",
                                   "Q2-38A~000004_2002",
                                   "Q2-38A~000005_2002",
                                   "Q2-38A~000006_2002",
                                   "Q2-38A~000001_2004",
                                   "Q2-38A~000002_2004",
                                   "Q2-38A~000003_2004",
                                   "Q2-38A~000004_2004",
                                   "Q2-38A~000005_2004",
                                   "Q2-38A~000006_2004",
                                   "Q2-38A~000001_2006",
                                   "Q2-38A~000002_2006",
                                   "Q2-38A~000003_2006",
                                   "Q2-38A~000004_2006",
                                   "Q2-38A~000005_2006",
                                   "Q2-38A~000006_2006",
                                   "Q2-38A~000001_2008",
                                   "Q2-38A~000002_2008",
                                   "Q2-38A~000004_2008",
                                   "Q2-38A~000005_2008",
                                   "Q2-38A~000003_2008",
                                   "Q2-38A~000006_2008",
                                   "Q2-38A~000007_2008",
                                   "VERSION_R28_XRND",
                                   "Q2-38A~000001_2010",
                                   "Q2-38A~000002_2010",
                                   "Q2-38A~000003_2010",
                                   "Q2-38A~000004_2010",
                                   "Q2-38A~000005_2010",
                                   "Q2-38A~000006_2010",
                                   "Q2-38A~000007_2010",
                                   "Q2-38A~000001_2012",
                                   "Q2-38A~000002_2012",
                                   "Q2-38A~000003_2012",
                                   "Q2-38A~000004_2012",
                                   "Q2-38A~000005_2012",
                                   "Q2-38A~000006_2012",
                                   "Q2-38A~000007_2012",
                                   "Q2-38A~000001_2014",
                                   "Q2-38A~000002_2014",
                                   "Q2-38A~000003_2014",
                                   "Q2-38A~000004_2014",
                                   "Q2-38A~000005_2014",
                                   "Q2-38A~000006_2014",
                                   "Q2-38A~000007_2014",
                                   "Q2-38A~000001_2016",
                                   "Q2-38A~000002_2016",
                                   "Q2-38A~000003_2016",
                                   "Q2-38A~000004_2016",
                                   "Q2-38A~000005_2016",
                                   "Q2-38A~000006_2016",
                                   "Q2-38A~000007_2016",
                                   "Q2-38A~000001_2018",
                                   "Q2-38A~000002_2018",
                                   "Q2-38A~000003_2018",
                                   "Q2-38A~000004_2018",
                                   "Q2-38A~000005_2018",
                                   "Q2-38A~000006_2018",
                                   "Q2-38A~000007_2018")



# mapping Qnames, actual questions, and survey year
dict_children <- data.frame(names = question_names_children, labels = varlabels_children) %>%
  mutate(year = str_sub(labels,-4,-1))
         
#children_data_labelled <- vallabels_children(new_data_children)
colnames(new_data_children) <- varlabels_children
children_data_labelled <- new_data_children

children_data_labelled <- children_data_labelled %>% 
  mutate(Y = `DATE OF BIRTH OF CHILD - YEAR`+15)

children_data_pivot <- children_data_labelled %>% 
  select(-starts_with("RACE OF R")) %>% 
  pivot_longer(cols = 'FATHER LIVE IN HH OF MOTHER? 1984':"HGC OF MOTHER AS OF MAY 1 (REV) 2016",
               names_to = 'variable') %>% 
  mutate(question = str_sub(variable,1,-5),
         year = as.integer(str_sub(variable,-4,-1)),
         gap = year - `DATE OF BIRTH OF CHILD - YEAR`) %>% 
  mutate(value_test = case_when(gap < 1 ~ "Not Applicable",
                                gap >=1 ~ "Applicable"))


# check how many children each mother has
mother_ids <- children_data_labelled %>% 
  select(MOTHER_ID) %>% 
  group_by(MOTHER_ID) %>% 
  summarise(children = n())

save(mother_ids, file = "./data/mother_ids.RData")


# SANITY CHECK: see how many NA responses are found
na_children <- children_data_pivot %>% 
  filter(value_test == 'Applicable',
         is.na(value)) %>% 
  mutate(count = 1) %>% 
  select('CHILD_ID', 'question','year', 'count')


#########################################
# working with the pivot longer data
#########################################

load('./data/intermediate1.RData')

# (a) does father live with family?
children_father_present = children_data_pivot %>%
                              filter(question == "FATHER LIVE IN HH OF MOTHER? ",
                                     gap > 0) %>%
                              left_join(all_data[c("ID.CODE.OF.CHILD", "ID.CODE.OF.MOTHER.OF.CHILD", "year_at_y", "gap_at_y")], 
                                          by=c("CHILD_ID"="ID.CODE.OF.CHILD",
                                               "MOTHER_ID"="ID.CODE.OF.MOTHER.OF.CHILD")) %>% 
                              filter(gap <= gap_at_y,
                                     year <= year_at_y) %>%
                              group_by(CHILD_ID, MOTHER_ID) %>%
                              summarize(father_present = mean(value, na.rm=TRUE))


all_data <- left_join(all_data,
                      children_father_present,
                      by = c("ID.CODE.OF.CHILD" = "CHILD_ID",
                             "ID.CODE.OF.MOTHER.OF.CHILD" = "MOTHER_ID"))


rm(children_father_present)

# (b) highest level of education expected at time of Y or most recently available
children_expected_ed = children_data_pivot %>%
                          filter(question ==  "HOW FAR CHILD EXPECTS TO GO IN SCHL ",
                                 gap > 0) %>%
                          left_join(all_data[c("ID.CODE.OF.CHILD", "ID.CODE.OF.MOTHER.OF.CHILD", "year_at_y", "gap_at_y")], 
                                    by=c("CHILD_ID"="ID.CODE.OF.CHILD",
                                         "MOTHER_ID"="ID.CODE.OF.MOTHER.OF.CHILD")) %>%
                          filter(gap <= gap_at_y,
                                 year <= year_at_y,
                                 !is.na(value)) %>% 
                          group_by(CHILD_ID, MOTHER_ID) %>%
                          mutate(max_gap = max(gap)) %>%
                          filter(gap == max_gap) %>%
                          select(c("CHILD_ID","MOTHER_ID","value")) %>%
                          rename("highest_expected_grade" = "value")


children_expected_ed$highest_expected_grade <- factor(children_expected_ed$highest_expected_grade,
                        levels=c(1.0,2.0,3.0,4.0,5.0,6.0),
                        labels=c("LEAVE HIGH SCHOOL BEFORE GRADUATION",
                                 "GRADUATE FROM HIGH SCHOOL",
                                 "GET SOME COLLEGE OR OTHER TRAINING",
                                 "GRADUATE FROM COLLEGE",
                                 "GET MORE THAN 4 YEARS OF COLLEGE",
                                 "SOMETHING ELSE"))

all_data <- left_join(all_data,
                      children_expected_ed,
                      by = c("ID.CODE.OF.CHILD" = "CHILD_ID",
                             "ID.CODE.OF.MOTHER.OF.CHILD" = "MOTHER_ID"))


save(all_data, file = "./data/intermediate2.RData")